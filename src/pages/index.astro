---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import SearchFilterBar from '../components/SearchFilterBar.astro';
import MainJobExplorerContainer from '../components/MainJobExplorerContainer.astro';

import { getCollection } from 'astro:content';
const jobEntries = await getCollection('jobs');

// Pre-calculate filter options for better performance
const guilds = [...new Set(jobEntries.map(entry => entry.data.guild))];
const mainSkills = [...new Set(jobEntries.map(entry => entry.data.mainSkill))];
const levels = [...new Set(jobEntries.map(entry => entry.data.level))];

---

<Layout>
	<Header />
	<SearchFilterBar guilds={guilds} mainSkills={mainSkills} levels={levels} />
	<MainJobExplorerContainer />
</Layout>

